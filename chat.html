<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Mengal ‚ù§Ô∏è Zainee ‚Äî Chat</title>
  <link rel="stylesheet" href="styles.css"/>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
  <div class="app">
    <header class="topbar">
      <h1>Chat Room</h1>
      <button onclick="logout()">Logout</button>
    </header>
    <main class="card">
      <h2 id="welcome"></h2>
      <ul id="messages" class="messages"></ul>
      <div class="composer">
        <input id="msgInput" placeholder="Type message..."/>
        <button onclick="sendMessage()">Send</button>
      </div>
    </main>
  </div>

<script>
  // LocalStorage se current user
  let currentUser = localStorage.getItem("currentUser");
  if(!currentUser){
    window.location.href = "index.html";
  }
  document.getElementById("welcome").textContent = "Welcome, " + currentUser + "!";

  // üî• Firebase Config (replace with your keys)
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    databaseURL: "https://YOUR_PROJECT.firebaseio.com",
    projectId: "YOUR_PROJECT",
    storageBucket: "YOUR_PROJECT.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const msgList = document.getElementById("messages");
  const input = document.getElementById("msgInput");

  function sendMessage(){
    if(input.value.trim() === "") return;
    db.ref("messages").push({
      user: currentUser,
      text: input.value,
      timestamp: Date.now()
    });
    input.value = "";
  }

  db.ref("messages").on("child_added", snapshot => {
    const msg = snapshot.val();
    let li = document.createElement("li");
    li.textContent = msg.user + ": " + msg.text;
    msgList.appendChild(li);
  });

  function logout(){
    localStorage.removeItem("currentUser");
    window.location.href = "index.html";
  }
</script>
</body>
</html>
